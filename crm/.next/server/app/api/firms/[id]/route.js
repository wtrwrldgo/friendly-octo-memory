"use strict";(()=>{var e={};e.id=5053,e.ids=[5053],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8644:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>v,patchFetch:()=>f,requestAsyncStorage:()=>m,routeModule:()=>p,serverHooks:()=>h,staticGenerationAsyncStorage:()=>y});var i={};t.r(i),t.d(i,{DELETE:()=>u,GET:()=>l,PUT:()=>c});var a=t(9303),n=t(8716),o=t(670),s=t(7070),d=t(9487);async function l(e,{params:r}){try{let{data:e,error:t}=await d.db.getFirmById(r.id);if(t)throw t;if(!e)return s.NextResponse.json({success:!1,error:"Firm not found"},{status:404});return s.NextResponse.json({success:!0,data:e},{status:200})}catch(e){return console.error("Error fetching firm:",e),s.NextResponse.json({success:!1,error:e.message||"Failed to fetch firm"},{status:500})}}async function c(e,{params:r}){try{let t=await e.json(),i=e.headers.get("Authorization"),a=i?.replace("Bearer ","")||e.cookies.get("authToken")?.value,n={};t.name&&(n.name=t.name),t.city&&(n.city=t.city),t.status&&(n.status=t.status),void 0!==t.logoUrl&&(n.logoUrl=t.logoUrl),void 0!==t.homeBannerUrl&&(n.homeBannerUrl=t.homeBannerUrl),void 0!==t.detailBannerUrl&&(n.detailBannerUrl=t.detailBannerUrl),void 0!==t.description&&(n.description=t.description),void 0!==t.address&&(n.address=t.address),void 0!==t.deliveryTime&&(n.deliveryTime=t.deliveryTime),"number"==typeof t.minOrder&&(n.minOrder=t.minOrder),"number"==typeof t.deliveryFee&&(n.deliveryFee=t.deliveryFee),"number"==typeof t.deliveryFeePercent&&(n.deliveryFeePercent=t.deliveryFeePercent),"number"==typeof t.bottleDeposit&&(n.bottleDeposit=t.bottleDeposit),"number"==typeof t.bottleDepositPrice&&(n.bottleDepositPrice=t.bottleDepositPrice),"number"==typeof t.scheduleDaysLimit&&(n.scheduleDaysLimit=t.scheduleDaysLimit),"number"==typeof t.scheduleTimeInterval&&(n.scheduleTimeInterval=t.scheduleTimeInterval),"boolean"==typeof t.isVisibleInClientApp&&(n.isVisibleInClientApp=t.isVisibleInClientApp),"boolean"==typeof t.minOrderEnabled&&(n.minOrderEnabled=t.minOrderEnabled),"boolean"==typeof t.deliveryFeeEnabled&&(n.deliveryFeeEnabled=t.deliveryFeeEnabled),"boolean"==typeof t.bottleDepositEnabled&&(n.bottleDepositEnabled=t.bottleDepositEnabled),t.deliveryFeeType&&(n.deliveryFeeType=t.deliveryFeeType);let{data:o,error:l}=await d.db.updateFirm(r.id,n,{authToken:a});if(l)throw l;return s.NextResponse.json({firm:o,success:!0},{status:200})}catch(e){return console.error("Error updating firm:",e),s.NextResponse.json({error:e.message||"Failed to update firm"},{status:500})}}async function u(e,{params:r}){try{let t=e.headers.get("Authorization"),i=t?.replace("Bearer ","")||e.cookies.get("authToken")?.value,{error:a}=await d.db.deleteFirm(r.id,{authToken:i});if(a)throw a;return s.NextResponse.json({message:"Firm deleted successfully"},{status:200})}catch(e){return console.error("Error deleting firm:",e),s.NextResponse.json({error:e.message||"Failed to delete firm"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/firms/[id]/route",pathname:"/api/firms/[id]",filename:"route",bundlePath:"app/api/firms/[id]/route"},resolvedPagePath:"/Users/musabekisakov/claudeCode/crm/app/api/firms/[id]/route.ts",nextConfigOutput:"",userland:i}),{requestAsyncStorage:m,staticGenerationAsyncStorage:y,serverHooks:h}=p,v="/api/firms/[id]/route";function f(){return(0,o.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:y})}},9487:(e,r,t)=>{async function i(e,r={},t){try{let i=t||null,a={"Content-Type":"application/json",...r.headers};i&&(a.Authorization=`Bearer ${i}`);let n=await fetch(`http://45.92.173.121/api${e}`,{...r,headers:a}),o=await n.json();if(!n.ok||!o.success)return{data:null,error:Error(o.error?.message||o.message||"Request failed")};return{data:o.data,error:null}}catch(e){return{data:null,error:e}}}t.d(r,{Z:()=>n,db:()=>a});let a={getFirms:async()=>i("/firms"),getFirmById:async e=>i(`/firms/${e}`),createFirm:async e=>i("/firms",{method:"POST",body:JSON.stringify(e)}),updateFirm:async(e,r,t)=>i(`/firms/${e}`,{method:"PUT",body:JSON.stringify(r)},t?.authToken),deleteFirm:async(e,r)=>i(`/firms/${e}`,{method:"DELETE"},r?.authToken),async getProducts(e){let r=e?`?firmId=${e}`:"";return i(`/products${r}`)},createProduct:async(e,r)=>i("/products",{method:"POST",body:JSON.stringify({firmId:e.firm_id,name:e.name,description:e.description,price:e.price,imageUrl:e.image_url,volume:e.volume,inStock:e.in_stock})},r?.authToken),async updateProduct(e,r,t){let a={};return void 0!==r.name&&(a.name=r.name),void 0!==r.description&&(a.description=r.description),void 0!==r.price&&(a.price=r.price),void 0!==r.image_url&&(a.imageUrl=r.image_url),void 0!==r.volume&&(a.volume=r.volume),void 0!==r.in_stock&&(a.inStock=r.in_stock),i(`/products/${e}`,{method:"PUT",body:JSON.stringify(a)},t?.authToken)},deleteProduct:async(e,r)=>i(`/products/${e}`,{method:"DELETE"},r?.authToken),async getOrders(e,r,t){let a=new URLSearchParams;e&&a.append("firmId",e),r&&a.append("branchId",r),t&&a.append("canAccessAllBranches","true");let n=a.toString()?`?${a.toString()}`:"";return i(`/orders${n}`)},getOrderById:async e=>i(`/orders/${e}`),updateOrderStatus:async(e,r)=>i(`/orders/${e}/status`,{method:"PUT",body:JSON.stringify({stage:r})}),createOrder:async e=>i("/orders",{method:"POST",body:JSON.stringify(e)}),async getDrivers(e,r,t,a){let n=new URLSearchParams;e&&n.append("firmId",e),r&&n.append("branchId",r),t&&n.append("canAccessAllBranches","true");let o=n.toString()?`?${n.toString()}`:"";return i(`/drivers${o}`,{},a?.authToken)},getDriverById:async e=>i(`/drivers/${e}`),createDriver:async(e,r)=>i("/drivers",{method:"POST",body:JSON.stringify({firmId:e.firmId,name:e.name,phone:e.phone,vehicleNumber:e.car_plate,carBrand:e.car_brand,carColor:e.car_color,driverNumber:e.driver_number?.toString()||"0"})},r?.authToken),async updateDriver(e,r,t){let a={};return void 0!==r.name&&(a.name=r.name),void 0!==r.phone&&(a.phone=r.phone),void 0!==r.car_plate&&(a.vehicleNumber=r.car_plate),void 0!==r.car_brand&&(a.carBrand=r.car_brand),void 0!==r.car_color&&(a.carColor=r.car_color),void 0!==r.is_available&&(a.isAvailable=r.is_available),i(`/drivers/${e}`,{method:"PUT",body:JSON.stringify(a)},t?.authToken)},deleteDriver:async(e,r)=>i(`/drivers/${e}`,{method:"DELETE"},r?.authToken),async getClients(e,r,t,a){let n=new URLSearchParams;e&&n.append("firmId",e),r&&n.append("branchId",r),t&&n.append("canAccessAllBranches","true");let o=n.toString()?`?${n.toString()}`:"";return i(`/clients${o}`,{},a?.authToken)},async getClientById(e,r,t){let a=new URLSearchParams;r&&a.append("firmId",r);let n=a.toString()?`?${a.toString()}`:"";return i(`/clients/${e}${n}`,{},t?.authToken)},deleteClient:async(e,r)=>i(`/clients/${e}`,{method:"DELETE"},r?.authToken)},n=a}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),i=r.X(0,[9276,5972],()=>t(8644));module.exports=i})();