"use strict";(()=>{var e={};e.id=9356,e.ids=[9356],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},291:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>h,patchFetch:()=>y,requestAsyncStorage:()=>m,routeModule:()=>u,serverHooks:()=>p,staticGenerationAsyncStorage:()=>l});var a={};t.r(a),t.d(a,{PATCH:()=>c});var n=t(9303),i=t(8716),s=t(670),o=t(7070),d=t(9487);async function c(e,{params:r}){try{let t=r.id,{reason:a}=await e.json();if(!a||"string"!=typeof a||0===a.trim().length)return o.NextResponse.json({error:"Rejection reason is required"},{status:400});let{data:n,error:i}=await d.db.getFirmById(t);if(i)throw i;if(!n)return o.NextResponse.json({error:"Firm not found"},{status:404});if("PENDING_REVIEW"!==n.status)return o.NextResponse.json({error:`Cannot reject firm. Current status is ${n.status}. Only PENDING_REVIEW firms can be rejected.`},{status:400});let{data:s,error:c}=await d.db.updateFirm(t,{status:"DRAFT",rejectionReason:a.trim(),submittedAt:null});if(c)throw c;return o.NextResponse.json({firm:s,message:"Firm rejected and returned to draft status."},{status:200})}catch(e){return console.error("Error rejecting firm:",e),o.NextResponse.json({error:e.message||"Failed to reject firm"},{status:500})}}let u=new n.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/firms/[id]/reject/route",pathname:"/api/firms/[id]/reject",filename:"route",bundlePath:"app/api/firms/[id]/reject/route"},resolvedPagePath:"/Users/musabekisakov/claudeCode/crm/app/api/firms/[id]/reject/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:m,staticGenerationAsyncStorage:l,serverHooks:p}=u,h="/api/firms/[id]/reject/route";function y(){return(0,s.patchFetch)({serverHooks:p,staticGenerationAsyncStorage:l})}},9487:(e,r,t)=>{async function a(e,r={},t){try{let a=t||null,n={"Content-Type":"application/json",...r.headers};a&&(n.Authorization=`Bearer ${a}`);let i=await fetch(`http://45.92.173.121/api${e}`,{...r,headers:n}),s=await i.json();if(!i.ok||!s.success)return{data:null,error:Error(s.error?.message||s.message||"Request failed")};return{data:s.data,error:null}}catch(e){return{data:null,error:e}}}t.d(r,{Z:()=>i,db:()=>n});let n={getFirms:async()=>a("/firms"),getFirmById:async e=>a(`/firms/${e}`),createFirm:async e=>a("/firms",{method:"POST",body:JSON.stringify(e)}),updateFirm:async(e,r,t)=>a(`/firms/${e}`,{method:"PUT",body:JSON.stringify(r)},t?.authToken),deleteFirm:async(e,r)=>a(`/firms/${e}`,{method:"DELETE"},r?.authToken),async getProducts(e){let r=e?`?firmId=${e}`:"";return a(`/products${r}`)},createProduct:async(e,r)=>a("/products",{method:"POST",body:JSON.stringify({firmId:e.firm_id,name:e.name,description:e.description,price:e.price,imageUrl:e.image_url,volume:e.volume,inStock:e.in_stock})},r?.authToken),async updateProduct(e,r,t){let n={};return void 0!==r.name&&(n.name=r.name),void 0!==r.description&&(n.description=r.description),void 0!==r.price&&(n.price=r.price),void 0!==r.image_url&&(n.imageUrl=r.image_url),void 0!==r.volume&&(n.volume=r.volume),void 0!==r.in_stock&&(n.inStock=r.in_stock),a(`/products/${e}`,{method:"PUT",body:JSON.stringify(n)},t?.authToken)},deleteProduct:async(e,r)=>a(`/products/${e}`,{method:"DELETE"},r?.authToken),async getOrders(e,r,t){let n=new URLSearchParams;e&&n.append("firmId",e),r&&n.append("branchId",r),t&&n.append("canAccessAllBranches","true");let i=n.toString()?`?${n.toString()}`:"";return a(`/orders${i}`)},getOrderById:async e=>a(`/orders/${e}`),updateOrderStatus:async(e,r)=>a(`/orders/${e}/status`,{method:"PUT",body:JSON.stringify({stage:r})}),createOrder:async e=>a("/orders",{method:"POST",body:JSON.stringify(e)}),async getDrivers(e,r,t,n){let i=new URLSearchParams;e&&i.append("firmId",e),r&&i.append("branchId",r),t&&i.append("canAccessAllBranches","true");let s=i.toString()?`?${i.toString()}`:"";return a(`/drivers${s}`,{},n?.authToken)},getDriverById:async e=>a(`/drivers/${e}`),createDriver:async(e,r)=>a("/drivers",{method:"POST",body:JSON.stringify({firmId:e.firmId,name:e.name,phone:e.phone,vehicleNumber:e.car_plate,carBrand:e.car_brand,carColor:e.car_color,driverNumber:e.driver_number?.toString()||"0"})},r?.authToken),async updateDriver(e,r,t){let n={};return void 0!==r.name&&(n.name=r.name),void 0!==r.phone&&(n.phone=r.phone),void 0!==r.car_plate&&(n.vehicleNumber=r.car_plate),void 0!==r.car_brand&&(n.carBrand=r.car_brand),void 0!==r.car_color&&(n.carColor=r.car_color),void 0!==r.is_available&&(n.isAvailable=r.is_available),a(`/drivers/${e}`,{method:"PUT",body:JSON.stringify(n)},t?.authToken)},deleteDriver:async(e,r)=>a(`/drivers/${e}`,{method:"DELETE"},r?.authToken),async getClients(e,r,t,n){let i=new URLSearchParams;e&&i.append("firmId",e),r&&i.append("branchId",r),t&&i.append("canAccessAllBranches","true");let s=i.toString()?`?${i.toString()}`:"";return a(`/clients${s}`,{},n?.authToken)},async getClientById(e,r,t){let n=new URLSearchParams;r&&n.append("firmId",r);let i=n.toString()?`?${n.toString()}`:"";return a(`/clients/${e}${i}`,{},t?.authToken)},deleteClient:async(e,r)=>a(`/clients/${e}`,{method:"DELETE"},r?.authToken)},i=n}};var r=require("../../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[9276,5972],()=>t(291));module.exports=a})();