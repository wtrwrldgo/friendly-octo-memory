(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[626],{6161:function(e,t,r){Promise.resolve().then(r.bind(r,6374))},6374:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return d}});var s=r(7437),a=r(2265),l=r(2252),o=r(9345),n=r(6337),i=r(6858),c=r(6281),u=r(1258);function d(){let{signIn:e}=(0,c.a)(),{t}=(0,u.ZK)(),[r,d]=(0,a.useState)(!1),[m,h]=(0,a.useState)(null),[x,g]=(0,a.useState)({email:"",password:""}),f=async r=>{r.preventDefault(),d(!0),h(null);try{let{error:r,user:s}=await e(x.email,x.password);if(r){h(r.message||t.auth.invalidCredentials),d(!1);return}let a=(null==s?void 0:s.role)==="WATERGO_ADMIN"?"/":"/firm-dashboard";window.location.href=a}catch(e){console.error("Login failed:",e),h(e.message||t.auth.loginFailed),d(!1)}};return(0,s.jsxs)("div",{className:"min-h-screen bg-[#0C1633] flex items-center justify-center p-4",children:[(0,s.jsxs)("div",{className:"absolute inset-0 overflow-hidden",children:[(0,s.jsx)("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-blue-500/10 rounded-full blur-3xl"}),(0,s.jsx)("div",{className:"absolute bottom-0 right-1/4 w-96 h-96 bg-indigo-500/10 rounded-full blur-3xl"})]}),(0,s.jsxs)("div",{className:"relative w-full max-w-md",children:[(0,s.jsxs)("div",{className:"text-center mb-10",children:[(0,s.jsxs)("h1",{className:"text-4xl font-bold text-white",children:["Water",(0,s.jsx)("span",{className:"text-blue-400",children:"Go"})]}),(0,s.jsx)("p",{className:"text-gray-400 mt-2",children:t.auth.managementDashboard})]}),(0,s.jsxs)("div",{className:"bg-white/5 backdrop-blur-xl border border-white/10 rounded-3xl p-8 shadow-2xl",children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-white mb-2",children:t.auth.welcomeBack}),(0,s.jsx)("p",{className:"text-gray-400",children:t.auth.signInToAccount})]}),(0,s.jsxs)("form",{onSubmit:f,className:"space-y-5",children:[m&&(0,s.jsxs)("div",{className:"flex items-center gap-3 p-4 bg-red-500/10 border border-red-500/20 rounded-xl relative z-50",children:[(0,s.jsx)(l.Z,{className:"w-5 h-5 text-red-400 flex-shrink-0"}),(0,s.jsx)("p",{className:"text-red-400 text-sm",children:m})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:t.auth.email}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:(0,s.jsx)(o.Z,{className:"w-5 h-5 text-gray-500"})}),(0,s.jsx)("input",{type:"email",required:!0,placeholder:t.auth.enterEmail,className:"w-full pl-12 pr-4 py-4 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 outline-none transition-all",value:x.email,onChange:e=>g({...x,email:e.target.value})})]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:t.auth.password}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:(0,s.jsx)(n.Z,{className:"w-5 h-5 text-gray-500"})}),(0,s.jsx)("input",{type:"password",required:!0,placeholder:t.auth.enterPassword,className:"w-full pl-12 pr-4 py-4 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 outline-none transition-all",value:x.password,onChange:e=>g({...x,password:e.target.value})})]})]}),(0,s.jsx)("button",{type:"submit",disabled:r,className:"w-full py-4 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-400 hover:to-blue-500 text-white font-semibold rounded-xl transition-all transform hover:scale-[1.02] active:scale-[0.98] disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 shadow-lg shadow-blue-500/25 flex items-center justify-center gap-2",children:r?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),(0,s.jsx)("span",{children:t.auth.signingIn})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:t.auth.signIn}),(0,s.jsx)(i.Z,{className:"w-5 h-5"})]})})]}),(0,s.jsxs)("div",{className:"flex items-center gap-4 my-6",children:[(0,s.jsx)("div",{className:"flex-1 h-px bg-white/10"}),(0,s.jsx)("span",{className:"text-gray-500 text-sm",children:t.auth.testAccounts}),(0,s.jsx)("div",{className:"flex-1 h-px bg-white/10"})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("button",{type:"button",onClick:()=>g({email:"admin@watergo.com",password:"admin123"}),className:"w-full p-4 bg-blue-500/10 hover:bg-blue-500/20 border border-blue-500/20 rounded-xl transition-all text-left group",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-blue-400 font-semibold text-sm",children:t.auth.watergoAdmin}),(0,s.jsx)("p",{className:"text-gray-500 text-xs mt-1",children:"admin@watergo.com"})]}),(0,s.jsx)(i.Z,{className:"w-4 h-4 text-blue-400 opacity-0 group-hover:opacity-100 transition-opacity"})]})}),(0,s.jsx)("button",{type:"button",onClick:()=>g({email:"owner@test.com",password:"password123"}),className:"w-full p-4 bg-emerald-500/10 hover:bg-emerald-500/20 border border-emerald-500/20 rounded-xl transition-all text-left group",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-emerald-400 font-semibold text-sm",children:t.auth.firmOwnerAccount}),(0,s.jsx)("p",{className:"text-gray-500 text-xs mt-1",children:"owner@test.com"})]}),(0,s.jsx)(i.Z,{className:"w-4 h-4 text-emerald-400 opacity-0 group-hover:opacity-100 transition-opacity"})]})})]})]}),(0,s.jsx)("p",{className:"text-center text-gray-500 text-sm mt-8",children:t.auth.copyright})]})]})}},6281:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return i},a:function(){return c}});var s=r(7437),a=r(2265),l=r(9376);let o="/api",n=(0,a.createContext)(void 0);function i(e){let{children:t}=e,[r,i]=(0,a.useState)(null),[c,u]=(0,a.useState)(null),[d,m]=(0,a.useState)(null),[h,x]=(0,a.useState)(!0),g=(0,l.useRouter)();(0,l.usePathname)(),(0,a.useEffect)(()=>{let e=localStorage.getItem("auth_token"),t=localStorage.getItem("auth_user"),r=localStorage.getItem("auth_firm");e&&t&&(m(e),i(JSON.parse(t)),r&&u(JSON.parse(r))),x(!1)},[]);let f=async()=>{i(null),u(null),m(null),localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),localStorage.removeItem("auth_firm"),localStorage.removeItem("userType"),localStorage.removeItem("userEmail"),localStorage.removeItem("firmId"),document.cookie="auth-token=; path=/; max-age=0",g.push("/login")},p={user:r,profile:r,token:d,loading:h,signIn:async(e,t)=>{try{console.log("Signing in with API_URL:",o);let r=await fetch("".concat(o,"/auth/staff/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})});console.log("Response status:",r.status);let s=await r.json();if(console.log("Response data:",s),!r.ok)throw Error(s.message||"Invalid email or password");let{token:a,user:l,firm:n}=s.data;return m(a),i(l),u(n),localStorage.setItem("auth_token",a),localStorage.setItem("auth_user",JSON.stringify(l)),n&&localStorage.setItem("auth_firm",JSON.stringify(n)),document.cookie="auth-token=".concat(a,"; path=/; max-age=").concat(2592e3),localStorage.setItem("userType","WATERGO_ADMIN"===l.role?"admin":"firm"),localStorage.setItem("userEmail",l.email),l.firmId&&localStorage.setItem("firmId",l.firmId),{error:null,user:l}}catch(e){return console.error("Sign in error:",e),{error:e}}},signOut:f,logout:f,isOwner:(null==r?void 0:r.role)==="OWNER",isManager:(null==r?void 0:r.role)==="MANAGER",isOperator:(null==r?void 0:r.role)==="OPERATOR",isWatergoAdmin:(null==r?void 0:r.role)==="WATERGO_ADMIN",canAccessAllBranches:(null==r?void 0:r.role)==="OWNER"||(null==r?void 0:r.role)==="WATERGO_ADMIN",firm:c,updateFirm:e=>{if(c){let t={...c,...e};u(t),localStorage.setItem("auth_firm",JSON.stringify(t))}}};return(0,s.jsx)(n.Provider,{value:p,children:t})}function c(){let e=(0,a.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},9763:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var s=r(2265),a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),o=(e,t)=>{let r=(0,s.forwardRef)((r,o)=>{let{color:n="currentColor",size:i=24,strokeWidth:c=2,absoluteStrokeWidth:u,className:d="",children:m,...h}=r;return(0,s.createElement)("svg",{ref:o,...a,width:i,height:i,stroke:n,strokeWidth:u?24*Number(c)/Number(i):c,className:["lucide","lucide-".concat(l(e)),d].join(" "),...h},[...t.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(m)?m:[m]])});return r.displayName="".concat(e),r}},2252:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},6858:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]])},6337:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])},9345:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(9763).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},9376:function(e,t,r){"use strict";var s=r(5475);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}})}},function(e){e.O(0,[258,971,117,744],function(){return e(e.s=6161)}),_N_E=e.O()}]);